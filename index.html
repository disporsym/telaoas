    <!DOCTYPE html>
    <html lang="en">

    <head>
    <title>Tel-AOASV009</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://static.line-scdn.net/liff/edge/versions/2.4.0/sdk.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    </head>

    <style>
    html,body,h1,h2,h3,h4,h5 {font-family: 'Kanit', sans-serif;background-color:rgb(255, 255, 255)}
    </style>
  

    <body>
        <!-- ////////////////////////////////////////////////////////////////////////////////////// -->
        
        <div id="cbmspinerload" class="w3-center w3-padding-64" style="display: none;">
            <div id="cbmspinerload1" class="spinner-grow text-muted"></div>
            <div id="cbmspinerload2" class="spinner-grow text-primary"></div>
            <div id="cbmspinerload3" class="spinner-grow text-success"></div>
            <div id="cbmspinerload4" class="spinner-grow text-info"></div>
            <div id="cbmspinerload5" class="spinner-grow text-warning"></div>
            <div id="cbmspinerload6" class="spinner-grow text-danger"></div>
            <div id="cbmspinerload7" class="spinner-grow text-secondary"></div>
            <div id="cbmspinerload8" class="spinner-grow text-dark"></div>
        </div>
        
        <!-- //////////////////////////////// Add/Update Button ////////////////////////////////////////////////////// -->
        
        <div id="cbmregist" class="w3-container w3-padding-48" style="display:block">
            <div class="w3-center w3-xxlarge" style="font-weight: bold;">เพิ่มเบอร์โทรศัพท์</div><br>
            <div class="w3-center">
            <button class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-hover-light-grey w3-hover-text-blue" onclick="add()" style="outline:none;background-color: #00b900;color: white; ">เพิ่ม</button>
            <button class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-hover-light-grey w3-hover-text-blue" onclick="update()" style="outline:none;background-color: #00b900;color: white; ">อัพเดท</button>
            </div><br>

<!-- ///////////////////////////Add Form//////////////////////////////////// -->
            <div id="add" style="display: none;">
            <div class="w3-xxlarge">สถานที่:</div>
            <select name="locationAdd" id="locationAdd" class="w3-white w3-padding-16 w3-large w3-round-large w3-border w3-border-grey " style="width:90%;outline:none;margin-left:5% ;">
            <option style="font-weight: bold;" disabled selected>เลือกสถานที่</option>
            <option value="mk">ทุ่งมหาเมฆ</option>
            <option value="sb">สุวรรณภูมิ</option>
            <option value="dm">ดอนเมือง</option>
            <optgroup label="ศูนย์ต่างจังหวัด">
                <option value="chm">ศูนย์เชียงใหม่และลูกข่าย</option>
                <option value="psl">ศูนย์พิษณุโลกและลูกข่าย</option>
                <option value="udn">ศูนย์อุดรธานีและลูกข่าย</option>
                <option value="nkr">ศูนย์นครราชสีมาและลูกข่าย</option>
                <option value="phu">ศูนย์ภูเก็ตและลูกข่าย</option>
                <option value="srt">ศูนย์สุราษฎร์ธานีและลูกข่าย</option>
                <option value="hyi">ศูนย์หาดใหญ่และลูกข่าย</option>
            </optgroup>
            <option value="oth">อื่นๆ</option>
            <option value="abr">ต่างประเทศ</option>
            <br><option value="emp">พนักงาน ศว.สว.</option>
            </select><br>
        
            <div id="myForm">
            <br><div class="w3-left w3-xxlarge">Site/กอง/ชื่อ:</div><br>
            <input id="siteAdd" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="text" placeholder="Site/กอง/ชื่อ"></input><br>
            
            <br><div class="w3-xxlarge">เบอร์โทร 1:</div>
            <input id="tel1Add" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์โทร 1"></input><br>
        
            <br><div class=" w3-xxlarge">เบอร์โทร 2:</div>
            <input id="tel2Add" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์โทร 2"></input><br>
            
            <br><div class="w3-xxlarge">เบอร์มือถือ:</div>
            <input id="mobileAdd" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์มือถือ"></input><br>
        
    </div>
        
        <div class="w3-container w3-center">
        <br><button value="submitadd" class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-pink w3-hover-light-grey w3-hover-text-blue" onclick="submit(this.value)" style="outline:none; ">SUBMIT</button>
            <!-- <div id="test" class="w3-xxlarge" style="font-weight: bold;"></div> -->
        </div>
    </div>


    <!-- ////////////////////////////Update Form/////////////////////////////////// -->
    <div id="update" style="display: none;">
        <div class="w3-xxlarge">สถานที่:</div>
        <select name="locationUpdate" id="locationUpdate" class="w3-white w3-padding-16 w3-large w3-round-large w3-border w3-border-grey " style="width:90%;outline:none;margin-left:5% ;" onchange="chooseLocation()">
        <option style="font-weight: bold;" disabled selected>เลือกสถานที่</option>
        <option value="mk">ทุ่งมหาเมฆ</option>
        <option value="sb">สุวรรณภูมิ</option>
        <option value="dm">ดอนเมือง</option>
        <optgroup label="ศูนย์ต่างจังหวัด">
            <option value="chm">ศูนย์เชียงใหม่และลูกข่าย</option>
            <option value="psl">ศูนย์พิษณุโลกและลูกข่าย</option>
            <option value="udn">ศูนย์อุดรธานีและลูกข่าย</option>
            <option value="nkr">ศูนย์นครราชสีมาและลูกข่าย</option>
            <option value="phu">ศูนย์ภูเก็ตและลูกข่าย</option>
            <option value="srt">ศูนย์สุราษฎร์ธานีและลูกข่าย</option>
            <option value="hyi">ศูนย์หาดใหญ่และลูกข่าย</option>
        </optgroup>
        <option value="oth">อื่นๆ</option>
        <option value="abr">ต่างประเทศ</option>
        <br><option value="emp">พนักงาน ศว.สว.</option>
        </select>
        <br>
    
        <br><div class="w3-left w3-xxlarge">Site/กอง/ชื่อ:  </div>
        <div id="loading" style="display: none;vertical-align: baseline;"><br>
            <span class="spinner-border spinner-border-sm text-muted" style="vertical-align: baseline;" ></span>
            <span style="vertical-align: baseline;">Loading...</span>
        </div>
        <select id="siteUpdate" class="w3-white w3-padding-16 w3-large w3-round-large w3-border w3-border-grey " style="width:90%;outline:none;margin-left:5% ;"  onchange="fillInform()">
        <option style="font-weight: bold;" disabled selected>เลือก Site/กอง/ชื่อ</option>
        </select><br>
        
        <br><div class="w3-xxlarge">เบอร์โทร 1:</div>
        <input id="tel1Update" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์โทร 1" ></input><br>
    
        <br><div class=" w3-xxlarge">เบอร์โทร 2:</div>
        <input id="tel2Update" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์โทร 2"></input><br>
        
        <br><div class="w3-xxlarge">เบอร์มือถือ:</div>
        <input id="mobileUpdate" class="w3-white w3-padding-16 w3-large w3-border w3-border-grey w3-round-large w3-text-black" style="width:90%;outline:none;margin-left: 5%;" type="tel" placeholder="เบอร์มือถือ"></input><br>
    

    
    <div class="w3-container w3-center">
    <br><button id="submitUpdate" class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-pink w3-hover-light-grey w3-hover-text-blue" onclick="submit(this.value)" style="outline:none; ">SUBMIT</button>
        <!-- <div id="test" class="w3-xxlarge" style="font-weight: bold;"></div> -->
    </div>
    
</div>
    </div>

    <!-- ////////////////////////////////////////////////////////////////////////////////////// -->

<br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="innolineuid" style="display:none;outline:none" placeholder="uid" readonly>
<br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="innolineudpname" style="display:none;outline:none" placeholder="udpname" readonly>
<!-- <br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="innolineupic" style="display:none;outline:none" placeholder="upic" readonly>
<br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="innolineumail" style="display:none;outline:none" placeholder="umail" readonly>
<br><input type="text" class="w3-border-0 w3-white w3-text-dark-grey" id="innolineufriend" style="display:none;outline:none" placeholder="ufriend" readonly>
<br><button class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-blue w3-hover-light-grey w3-hover-text-blue" onclick="logOut()" style="display:none;outline:none; ">LOGOUT<i class="material-icons"> mouse</i></button>

<button class="w3-button w3-padding-16 w3-round-large w3-xlarge w3-blue w3-hover-light-grey w3-hover-text-blue" onclick="temp()" style="outline:none; "><< BACK</button> -->

<!-- ////////////////////////////////////////////////////////////////////////////////////// -->

        <script>

            ////////////////////////////////////////Global Var//////////////////////

        var fullArray ;

        ////////////////////////////////////////////////////////////////////////
 function add(){
        document.getElementById("add").style.display = "block";
        document.getElementById("update").style.display = "none";
        document.getElementById("locationAdd").value = "เลือกสถานที่";
        document.getElementById("siteAdd").value = null;
        document.getElementById("tel1Add").value = null;
        document.getElementById("tel2Add").value = null;
        document.getElementById("mobileAdd").value = null;
        
 }
 
 function update(){
        document.getElementById("add").style.display = "none";
        document.getElementById("update").style.display = "block";
        document.getElementById("locationUpdate").value = "เลือกสถานที่";
        document.getElementById("siteUpdate").value = "เลือก Site/กอง/ชื่อ";
        document.getElementById("tel1Update").value = null;
        document.getElementById("tel2Update").value = null;
        document.getElementById("mobileUpdate").value = null;
    
 }

            ////////////////////////////////////////////////////////////////////////
            
    function chooseLocation() {
            document.getElementById("siteUpdate").innerHTML = null;
            document.getElementById("tel1Update").value = null;
            document.getElementById("tel2Update").value = null;
            document.getElementById("mobileUpdate").value = null;
            document.getElementById("loading").style.display = "block"

        var location = document.getElementById("locationUpdate").value ;
        console.log(location)
        if (location!="สถานที่"){
        var webhookdatachck = {
            "topic": "html",
            "check": "sendchecksite",
            "location": location
        }
        cbmwebhookCheckRegist(webhookdatachck)
        }
    }
            ////////////////////////////////////////////////////////////////////////

        function cbmwebhookCheckRegist(webhookdatachck) {
        $.ajax(
            {
            type: "POST",
            url: "https://script.google.com/macros/s/AKfycbzWqGZkDjNBnfZs4OVP9VRS_I_pRVFLUlrtQu-nfdZyLY_74clJlBYiBA/exec", //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            data: webhookdatachck,
            dataType: "JSON",
            success: function (uchck) {
                
                var aaa = uchck.message.aaa;
                fullArray = aaa;
                console.log(fullArray)
                getValue()    
                      
            }
            }
        );
        }    

        ////////////////////////////////////////////////////////////////////////

        function getValue(){
       
            var addsite = document.getElementById("siteUpdate");
            var option = document.createElement("option");
            option.text = "เลือก Site/กอง/ชื่อ";
            addsite.add(option)
            for(var i=0; i < fullArray.length ; i++){
                var siteArray = fullArray[i][0];
                //console.log(siteArray)
                var addsite = document.getElementById("siteUpdate");
                var option = document.createElement("option")
                option.text = siteArray;
                addsite.add(option);

                }
                document.getElementById("loading").style.display = "none"
       
            }

        function fillInform(){
            var siteValue = document.getElementById("siteUpdate").value;
                        console.log(fullArray)
                for(var i=0; i < fullArray.length ; i++){
                    if(siteValue==fullArray[i][0]){
                    document.getElementById("tel1Update").value = fullArray[i][1]
                    document.getElementById("tel2Update").value = fullArray[i][2]
                    document.getElementById("mobileUpdate").value = fullArray[i][3]
                }
            }
        }

        function submit(value){
            
            console.log(value)
            if(value=="submitadd"){
            var location = document.getElementById("locationAdd").value ;
            var site = document.getElementById("siteAdd").value ;
            var tel1 = document.getElementById("tel1Add").value ;
            var tel2 = document.getElementById("tel2Add").value ;
            var mobile = document.getElementById("mobileAdd").value ;
            var lineid = document.getElementById("innolineuid").value;
            var linename = document.getElementById("innolineudpname").value;
            var webhookdatachck = {
            "topic": "html",
            "check":"sendsubmitadd",
            "location": location,
            "site": site,
            "tel1": tel1,
            "tel2": tel2,
            "mobile":mobile,
            "lineid" : lineid,
            "linename": linename
                }
            }

            else
            {
            var location = document.getElementById("locationUpdate").value ;
            var site = document.getElementById("siteUpdate").value ;
            var tel1 = document.getElementById("tel1Update").value ;
            var tel2 = document.getElementById("tel2Update").value ;
            var mobile = document.getElementById("mobileUpdate").value ;
            var lineid = document.getElementById("innolineuid").value;
            var linename = document.getElementById("innolineudpname").value;
            var webhookdatachck = {
            "topic": "html",
            "check":"sendsubmitupdate",
            "location": location,
            "site": site,
            "tel1": tel1,
            "tel2": tel2,
            "mobile":mobile,
            "lineid" : lineid,
            "linename": linename
                }  
            }
        cbmwebhookCheckRegist(webhookdatachck)
        alert("รอพี่เวิด Approve นะฮะ")
        liff.closeWindow()
    }

    async function getUserProfile() {
      const profile = await liff.getProfile()
    //   document.getElementById("innolinedis").append(profile.displayName) 
      document.getElementById("innolineuid").value = profile.userId
      document.getElementById("innolineudpname").value = profile.displayName
      //document.getElementById("innolineupic").value = profile.pictureUrl
      //document.getElementById("innolineumail").value = liff.getDecodedIDToken().email
    //   var varinnolineuid = profile.userId
    //   var varinnolineudpname = profile.displayName
      //var varinnolineupic = profile.pictureUrl
      //var varinnolineumail = liff.getDecodedIDToken().email
      //sendMsglogedin(varinnolineuid,varinnolineudpname)
}

async function main() {
  // document.getElementById("innocarspinerload").style.display = "block";
  liff.ready.then(() => { 
      // if (liff.isInClient()) { //isincli
        if (liff.isLoggedIn()) {
          getUserProfile();
        //   getFriendship();
        } 
        else {
          liff.login()
        }
      // } //isincli
      // else { //isincli
      //   location.replace("https://ownez.site/inno/404line"); //isincli
      // } //isincli
  })
  await liff.init({ liffId: "1655566430-ap6yZxdv" })
}

// async function main() {
//   liff.ready.then(() => {
//     if (liff.isLoggedIn()) {
//       document.getElementById("innocarspinerload").style.display = "none";
//       document.getElementById("innocarmenu1").style.display = "block";
//       document.getElementById("innocarmenu2.1.1").style.display = "block";
//       document.getElementById("innocarmenu2.1.2").style.display = "block";
//       getUserProfile()
//       getFriendship()
//     }else{
//       liff.login()
//     }
//   })
//   await liff.init({ liffId: "1655566430-ap6yZxdvs" })
// }

main();

        </script>
        </body>

        </html>